<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<post>
    <author>Seung Yeop Kim</author>
    <comments/>
    <content>@DbLookup in Lotus' Domino allows you to query a table and return values from a &lt;br&gt;specific record.&lt;br&gt;&lt;br&gt;Go to Domino Designer and open the form you want to update. To begin this &lt;br&gt;example, we'll create another button named \\&amp;quot;Update Customer Information\\&amp;quot; using &lt;br&gt;the Create &amp;gt; Hotspot &amp;gt; Button Menu. In the Action pane for the Button, enter the &lt;br&gt;following formula: &lt;br&gt;&lt;br&gt;FIELD Customer_Number := @DbLookup(\\&amp;quot;ODBC\\&amp;quot;:\\&amp;quot;NOCACHE\\&amp;quot; ; \\&amp;quot;MYAS400\\&amp;quot; ; \\&amp;quot;DEMOUSER\\&amp;quot; ; &lt;br&gt;\\&amp;quot;demo21\\&amp;quot; ; \\&amp;quot;DEMOLIB.DEMO_CUST\\&amp;quot;;&amp;nbsp;&amp;nbsp;\\&amp;quot;CUSTNO\\&amp;quot; ; \\&amp;quot;CUSTDE\\&amp;quot; ; Customer_Name); All&lt;br&gt;&lt;br&gt;These fields need to be changed to match your environment:&lt;br&gt;&lt;br&gt;\\&amp;quot;MYAS400\\&amp;quot; - your ODBC data Source Name &lt;br&gt;\\&amp;quot;DEMOUSER\\&amp;quot; - a valid AS/400 profile &lt;br&gt;\\&amp;quot;demo21\\&amp;quot; - the password for that profile &lt;br&gt;\\&amp;quot;DEMOLIB\\&amp;quot; - the library containing your file &lt;br&gt;\\&amp;quot;DEMO_CUST\\&amp;quot; - the name of the file &lt;br&gt;\\&amp;quot;CUSTDE\\&amp;quot; - customer field (AS/400) &lt;br&gt;\\&amp;quot;CUSTNO\\&amp;quot; - customer number field (AS/400) &lt;br&gt;\\&amp;quot;Customer_Name\\&amp;quot; - customer field (Domino) &lt;br&gt;\\&amp;quot;Customer_Number\\&amp;quot; - customer field (Domino) &lt;br&gt;&lt;br&gt;Now let's test this formula. Save this form and switch to the Domino Client. &lt;br&gt;Create a new document based on your form and use the Select Customer Button to &lt;br&gt;place a name in the customer field. Next, click the Update Customer Information &lt;br&gt;Button to query the AS/400 for the Customer Number. If the update completes &lt;br&gt;successfully, return to Domino Designer and update the formula for the Update &lt;br&gt;Customer Information Button with the following formula additions. These &lt;br&gt;additional statements will update the remaining fields in the document. Be sure &lt;br&gt;to match the field parameters in the statements with the correct field names in &lt;br&gt;the Domino form and the AS/400 table. &lt;br&gt;&lt;br&gt;FIELD Customer_Number := @DbLookup(\\&amp;quot;ODBC\\&amp;quot;:\\&amp;quot;NOCACHE\\&amp;quot; ; \\&amp;quot;MYAS400\\&amp;quot; ; \\&amp;quot;DEMOUSER\\&amp;quot; ; &lt;br&gt;\\&amp;quot;demo21\\&amp;quot; ; \\&amp;quot;DEMOLIB.DEMO_CUST\\&amp;quot;;&amp;nbsp;&amp;nbsp;\\&amp;quot;CUSTNO\\&amp;quot; ; \\&amp;quot;CUSTDE\\&amp;quot; ; Customer_Name);&lt;br&gt;&lt;br&gt;FIELD Customer_Phone := @DbLookup(\\&amp;quot;ODBC\\&amp;quot;:\\&amp;quot;NOCACHE\\&amp;quot; ; \\&amp;quot;MYAS400\\&amp;quot; ; \\&amp;quot;DEMOUSER\\&amp;quot; ; &lt;br&gt;\\&amp;quot;demo21\\&amp;quot; ; \\&amp;quot;DEMOLIB.DEMO_CUST\\&amp;quot;;&amp;nbsp;&amp;nbsp;\\&amp;quot;PHONE\\&amp;quot; ; \\&amp;quot;CUSTDE\\&amp;quot; ; Customer_Name); &lt;br&gt;&lt;br&gt;FIELD Customer_City := @DbLookup(\\&amp;quot;ODBC\\&amp;quot;:\\&amp;quot;NOCACHE\\&amp;quot; ; \\&amp;quot;MYAS400\\&amp;quot; ; \\&amp;quot;DEMOUSER\\&amp;quot; ; &lt;br&gt;\\&amp;quot;demo21\\&amp;quot; ; \\&amp;quot;DEMOLIB.DEMO_CUST\\&amp;quot;;&amp;nbsp;&amp;nbsp;\\&amp;quot;CITY\\&amp;quot; ; \\&amp;quot;CUSTDE\\&amp;quot; ; Customer_Name); &lt;br&gt;&lt;br&gt;FIELD Customer_State := @DbLookup(\\&amp;quot;ODBC\\&amp;quot;:\\&amp;quot;NOCACHE\\&amp;quot; ; \\&amp;quot;MYAS400\\&amp;quot; ; \\&amp;quot;DEMOUSER\\&amp;quot; ; &lt;br&gt;\\&amp;quot;demo21\\&amp;quot; ; \\&amp;quot;DEMOLIB.DEMO_CUST\\&amp;quot;;&amp;nbsp;&amp;nbsp;\\&amp;quot;STATE\\&amp;quot; ; \\&amp;quot;CUSTDE\\&amp;quot; ; Customer_Name);&amp;nbsp;&amp;nbsp;All &lt;br&gt;&lt;br&gt;Each of the four FIELD statements in the above formula executes a @DbLookup &lt;br&gt;function to query the AS/400 and update a field on the document. &lt;br&gt;&lt;br&gt;Now we'll test the complete application by saving the form and switching to the &lt;br&gt;Domino Client. Create a new document based on your form and select a customer &lt;br&gt;with the Select Customer Button. Finally, use the Update Customer Information &lt;br&gt;Button to get values for the remaining fields on the document. If everything has &lt;br&gt;worked correctly, your document should be updated. Finally, if you save several &lt;br&gt;documents created this way, your view should show complete information for each &lt;br&gt;document.&lt;br&gt;</content>
    <postId>0870CF8C-BF12-497E-92F3-A062BE79CE89</postId>
    <pubDate>2001-09-26T00:00:00-04:00</pubDate>
    <title>AS/400 TIPS:Using @DbLookup in Lotus Domino to update a document</title>
</post>
